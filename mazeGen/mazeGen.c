#include <stdlib.h>

#include "mazeGen.h"

static const uint8_t Maze[] PROGMEM = 
{
  0x32, 0x1A, 0x1C, 0x1E, 0x14, 0x1A, 0x1E, 0x1C, 0x1C, 0x1C, 0x16, 0x18, 0x1E, 0x1C, 0x16, 0x12, 
  0x13, 0x19, 0x16, 0x19, 0x16, 0x13, 0x19, 0x1C, 0x16, 0x1A, 0x1D, 0x1C, 0x15, 0x1A, 0x15, 0x13, 
  0x13, 0x18, 0x1D, 0x14, 0x19, 0x17, 0x18, 0x16, 0x13, 0x13, 0x1A, 0x1C, 0x16, 0x1B, 0x1C, 0x15, 
  0x19, 0x1C, 0x1C, 0x1C, 0x16, 0x19, 0x16, 0x13, 0x13, 0x11, 0x13, 0x12, 0x13, 0x11, 0x1A, 0x16, 
  0x12, 0x1A, 0x1E, 0x14, 0x19, 0x16, 0x19, 0x15, 0x19, 0x16, 0x19, 0x17, 0x19, 0x1C, 0x15, 0x13, 
  0x13, 0x13, 0x19, 0x1C, 0x16, 0x19, 0x1C, 0x1C, 0x16, 0x13, 0x1A, 0x15, 0x1A, 0x16, 0x12, 0x13, 
  0x13, 0x19, 0x16, 0x1A, 0x1D, 0x16, 0x1A, 0x16, 0x13, 0x19, 0x1D, 0x1C, 0x15, 0x19, 0x17, 0x13, 
  0x1B, 0x1C, 0x15, 0x19, 0x16, 0x13, 0x11, 0x13, 0x19, 0x1C, 0x1C, 0x16, 0x1A, 0x14, 0x13, 0x13, 
  0x13, 0x1A, 0x1C, 0x1C, 0x15, 0x19, 0x16, 0x1B, 0x1E, 0x1C, 0x16, 0x13, 0x19, 0x1C, 0x15, 0x13, 
  0x11, 0x13, 0x18, 0x16, 0x1A, 0x16, 0x13, 0x13, 0x13, 0x18, 0x17, 0x19, 0x1C, 0x1C, 0x1C, 0x17, 
  0x1A, 0x15, 0x1A, 0x15, 0x13, 0x13, 0x13, 0x13, 0x19, 0x16, 0x19, 0x16, 0x1A, 0x1C, 0x14, 0x13, 
  0x13, 0x1A, 0x1D, 0x16, 0x13, 0x19, 0x15, 0x19, 0x14, 0x13, 0x12, 0x19, 0x17, 0x1A, 0x16, 0x13, 
  0x13, 0x19, 0x16, 0x13, 0x19, 0x1C, 0x1C, 0x1C, 0x1C, 0x15, 0x19, 0x16, 0x13, 0x13, 0x19, 0x15, 
  0x13, 0x18, 0x15, 0x19, 0x1C, 0x1C, 0x1C, 0x1E, 0x1C, 0x1C, 0x16, 0x13, 0x13, 0x13, 0x18, 0x16, 
  0x1B, 0x1C, 0x1C, 0x16, 0x1A, 0x1C, 0x16, 0x19, 0x1C, 0x16, 0x19, 0x15, 0x13, 0x19, 0x16, 0x13, 
  0x11, 0x1A, 0x1C, 0x17, 0x13, 0x12, 0x13, 0x1A, 0x16, 0x1B, 0x1C, 0x1C, 0x17, 0x12, 0x13, 0x13, 
  0x1A, 0x15, 0x12, 0x13, 0x13, 0x13, 0x19, 0x15, 0x13, 0x11, 0x1A, 0x16, 0x19, 0x15, 0x19, 0x17, 
  0x19, 0x16, 0x13, 0x13, 0x13, 0x19, 0x1C, 0x16, 0x19, 0x16, 0x13, 0x19, 0x1C, 0x1E, 0x16, 0x13, 
  0x1A, 0x15, 0x19, 0x17, 0x13, 0x1A, 0x1C, 0x1D, 0x16, 0x13, 0x19, 0x16, 0x1A, 0x15, 0x13, 0x13, 
  0x1B, 0x1C, 0x16, 0x13, 0x13, 0x19, 0x16, 0x1A, 0x15, 0x19, 0x16, 0x13, 0x13, 0x18, 0x15, 0x13, 
  0x19, 0x16, 0x13, 0x11, 0x13, 0x1A, 0x15, 0x11, 0x1A, 0x16, 0x19, 0x15, 0x19, 0x1C, 0x16, 0x13, 
  0x18, 0x15, 0x19, 0x16, 0x13, 0x19, 0x1C, 0x16, 0x13, 0x19, 0x1C, 0x1C, 0x1C, 0x1C, 0x17, 0x13, 
  0x1A, 0x1C, 0x1C, 0x17, 0x19, 0x16, 0x1A, 0x15, 0x19, 0x16, 0x18, 0x1C, 0x16, 0x1A, 0x15, 0x13, 
  0x19, 0x16, 0x12, 0x13, 0x1A, 0x15, 0x1B, 0x1C, 0x16, 0x19, 0x1C, 0x16, 0x19, 0x17, 0x12, 0x13, 
  0x1A, 0x15, 0x1B, 0x15, 0x13, 0x12, 0x13, 0x1A, 0x1D, 0x1C, 0x16, 0x19, 0x16, 0x1B, 0x15, 0x13, 
  0x13, 0x12, 0x13, 0x1A, 0x15, 0x13, 0x13, 0x19, 0x1C, 0x16, 0x19, 0x14, 0x13, 0x11, 0x1A, 0x15, 
  0x13, 0x19, 0x17, 0x13, 0x18, 0x17, 0x13, 0x18, 0x16, 0x19, 0x1C, 0x16, 0x19, 0x16, 0x13, 0x12, 
  0x1B, 0x16, 0x11, 0x19, 0x16, 0x1B, 0x1D, 0x1C, 0x15, 0x1A, 0x1C, 0x17, 0x12, 0x13, 0x13, 0x13, 
  0x11, 0x19, 0x1E, 0x14, 0x13, 0x13, 0x1A, 0x1C, 0x1C, 0x15, 0x12, 0x13, 0x13, 0x13, 0x13, 0x13, 
  0x1A, 0x1C, 0x17, 0x1A, 0x15, 0x11, 0x19, 0x16, 0x1A, 0x16, 0x1B, 0x15, 0x13, 0x13, 0x19, 0x17, 
  0x1B, 0x16, 0x11, 0x19, 0x16, 0x1A, 0x1C, 0x15, 0x13, 0x19, 0x15, 0x1A, 0x17, 0x1B, 0x14, 0x13, 
  0x11, 0x19, 0x1C, 0x1C, 0x1D, 0x15, 0x18, 0x1C, 0x1D, 0x1C, 0x1C, 0x15, 0x11, 0x19, 0x1C, 0x55
};

uint8_t generateMaze(maze_tile tiles[][MAZE_HEIGHT], uint16_t start, uint16_t length) {
  uint8_t xInit = start / MAZE_WIDTH;
  uint8_t yInit = start % MAZE_WIDTH;

  if (length == 0) {
    return SUCCESS;
  }

  for (uint8_t x = xInit; x < MAZE_WIDTH; x++) {
    for (uint8_t y = yInit; y < MAZE_HEIGHT; y++) {
      tiles[x][y].field = pgm_read_byte(&Maze[x*MAZE_HEIGHT + y]); 
      length --;
      if (length == 0) {
        break;
      }
    }
  }
  return SUCCESS;
}
